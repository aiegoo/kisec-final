<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <title>reveal-md</title>
    <link rel="shortcut icon" href="./favicon.ico" />
    <link rel="stylesheet" href="./dist/reset.css" />
    <link rel="stylesheet" href="./dist/reveal.css" />
    <link rel="stylesheet" href="./dist/theme/black.css" id="theme" />
    <link rel="stylesheet" href="./css/highlight/base16/zenburn.css" />

  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section data-markdown data-separator="\r?\n---\r?\n" data-separator-vertical="\r?\n----\r?\n">
          <textarea data-template>
            <!-- .slide: data-state="slide-config" -->
<!--
revealOptions:
  slideNumber: true
  transition: fade
-->

# Host Compromise Investigation

---

## üìã Executive Summary

- Chromium Snap package vulnerability exploitation led to malicious payload delivery
- Pre-existing Jenkins user account hijacked for establishing persistence
- Mumblehard malware deployed to `/dev/shm/duet` targeting c3pool.org
- BPFDoor rootkit implanted for kernel-level persistence and backdoor access

---

## üíª Compromised System Details

- Ubuntu 24.04.2 LTS Noble
- Kernel Version: 6.11.0
- Compromised User: Jenkins
- CVEs Identified: 3

---

## ‚è±Ô∏è Attack Chain Timeline

1. Chromium Snap vulnerability exploited to drop malicious loader
2. Jenkins user account hijacked as execution context
3. Mumblehard Miner & BPFDoor backdoor installed via scheduled tasks
4. Cron job created for continuous mining operations
5. BPFDoor rootkit + data exfiltration to mining pool
6. AnyDesk credentials compromised for remote access

---

## ü¶† Malware Artifacts Discovered

- Mumblehard Miner: Crypto mining malware (**HIGH IMPACT**)
- BPFDoor Rootkit: Kernel-level backdoor (**STEALTH**)
- Malicious Cron Job:
  ```
  * * * * * /usr/bin/flock -n /var/tmp/verl.lock -c 'cd /dev/shm/duet; exec ./app ...'
  ```
- Rootkit Detection Evidence:
  ```
  /proc/1656590/stack:[<0>] unix_seqpacket_recvmsg+0x43/0x70
  ```

---

## üïµÔ∏è BPFDoor Rootkit Analysis

- Detection Method: Kernel stack analysis revealing `unix_seqpacket_recvmsg` hooks
- Technology: eBPF-based kernel module for stealth operations
- eBPF Programs Identified:
  ```
  2039: cgroup_skb  name sd_fw_ingress  tag 6deef7357e7b4530  gpl
  2040: cgroup_device  name sd_devices  tag c8b47a902f1cc68b  gpl
  ```

---

## üî¨ Forensic Investigation Methodology

- Vulnerability assessment protocols
- Malware detection and analysis techniques
- Rootkit identification methodologies
- System integrity verification processes

---

## üõ°Ô∏è Comprehensive Remediation

- Mumblehard miner binaries purged
- BPFDoor rootkit completely removed
- All malicious cron jobs deleted
- Jenkins user activities cleared

---

## üéì Key Lessons Learned

- Snap-based applications represent significant attack surfaces
- Kernel-level eBPF-based rootkits are increasing in Linux environments
- Scheduled cron jobs remain highly effective persistence mechanisms

---

## üöÄ Future Security Recommendations

- Complete clean OS installation with data backup
- Enable system-wide application confinement
- Reduce Snap package usage
- Establish automated kernel update monitoring

---

## üìö Investigation Documentation

- [GitHub Wiki](https://github.com/aiegoo/siem): Comprehensive investigation architecture and methodology

---

## ‚úÖ Investigation Complete

- 100% Malware Removed
- 0 Active Threats
- Full System Integrity
- 24/7 SIEM Monitoring

---

# Presence Before and After
Identity is not a login ‚Äî it's a shadow that moves with the user
Note:
We often ask who is trying to access the system ‚Äî but rarely when, from where, and in what state...

---

# Environment
The quiet context: IP, hardware, entropy ‚Äî all whisper who you are
Note:
The machine doesn‚Äôt care about names. It notices voltages, entropy, keystroke rhythms...

---

# Forms Nowhere, Now Everywhere
Authentication without asking ‚Äî the body speaks before the mouth
Note:
The old model asked us to prove ourselves ‚Äî but now, the proof is already here...

---

# Signals
A capsule signed by reality, decoded by trust
Note:
All these signals ‚Äî the capsule ‚Äî are bundled into a signed whisper. The system listens...

---

# Superposition of Presence
You exist, and don‚Äôt ‚Äî until the system observes your trace
Note:
In quantum mechanics, particles don‚Äôt have states until observed. Our system borrows this metaphor...

---

# Trust Begins Where the Wire Ends
No perimeter, no gateway ‚Äî only confidence in the origin of motion
Note:
Perimeters have dissolved. There are no more walls, only waves. Trust must now travel with the entity...

---

<!-- Section Breaker GIF -->
<div style="text-align:center;">
  <img src="assets/breaker.gif" alt="Section Breaker" style="max-width:70%;"/>
</div>

---


          </textarea>
        </section>
      </div>
    </div>

    <script src="./dist/reveal.js"></script>

    <script src="./mermaid/dist/mermaid.min.js"></script>

    <script src="./plugin/markdown/markdown.js"></script>
    <script src="./plugin/highlight/highlight.js"></script>
    <script src="./plugin/zoom/zoom.js"></script>
    <script src="./plugin/notes/notes.js"></script>
    <script src="./plugin/math/math.js"></script>
    <script>
      function extend() {
        var target = {};
        for (var i = 0; i < arguments.length; i++) {
          var source = arguments[i];
          for (var key in source) {
            if (source.hasOwnProperty(key)) {
              target[key] = source[key];
            }
          }
        }
        return target;
      }

      // default options to init reveal.js
      var defaultOptions = {
        controls: true,
        progress: true,
        history: true,
        center: true,
        transition: 'default', // none/fade/slide/convex/concave/zoom
        slideNumber: true,
        highlight: {
          highlightOnLoad: false
        },
        plugins: [
          RevealMarkdown,
          RevealHighlight,
          RevealZoom,
          RevealNotes,
          RevealMath
        ]
      };

      // options from URL query string
      var queryOptions = Reveal().getQueryHash() || {};

      var options = extend(defaultOptions, {"_":["slides.md"],"static":"dist"}, queryOptions);
    </script>


    <script>
      Reveal.initialize(options);
      Reveal.addEventListener('ready', function (event) {
        const blocks = Reveal.getRevealElement().querySelectorAll('pre code:not(.mermaid)');
        const hlp = Reveal.getPlugin('highlight');
        blocks.forEach(hlp.highlightBlock);
      });
    </script>

    <script>
      const mermaidOptions = extend({ startOnLoad: false }, {});
      mermaid.startOnLoad = false;
      mermaid.initialize(mermaidOptions);
      const cb = function (event) {
        mermaid.init(mermaidOptions, '.stack.present > .present pre code.mermaid');
        mermaid.init(mermaidOptions, '.slides > .present:not(.stack) pre code.mermaid');
      }
      Reveal.addEventListener('ready', cb);
      Reveal.addEventListener('slidetransitionend', cb);
    </script>
  </body>
</html>
